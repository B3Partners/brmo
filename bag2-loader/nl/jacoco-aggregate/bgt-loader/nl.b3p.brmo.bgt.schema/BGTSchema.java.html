<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="nl"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>BGTSchema.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">BRMO BAG 2.0 loader</a> &gt; <a href="../index.html" class="el_bundle">bgt-loader</a> &gt; <a href="index.source.html" class="el_package">nl.b3p.brmo.bgt.schema</a> &gt; <span class="el_source">BGTSchema.java</span></div><h1>BGTSchema.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2021 B3Partners B.V.
 *
 * SPDX-License-Identifier: MIT
 *
 */

package nl.b3p.brmo.bgt.schema;

import static nl.b3p.brmo.schema.mapping.SimpleDateFormatAttributeColumnMapping.PATTERN_XML_DATE;
import static nl.b3p.brmo.schema.mapping.SimpleDateFormatAttributeColumnMapping.PATTERN_XML_TIMESTAMP;

import nl.b3p.brmo.schema.Schema;
import nl.b3p.brmo.schema.mapping.AttributeColumnMapping;
import nl.b3p.brmo.schema.mapping.BooleanAttributeColumnMapping;
import nl.b3p.brmo.schema.mapping.DoubleAttributeColumnMapping;
import nl.b3p.brmo.schema.mapping.GeometryAttributeColumnMapping;
import nl.b3p.brmo.schema.mapping.IntegerAttributeColumnMapping;
import nl.b3p.brmo.schema.mapping.OneToManyColumnMapping;
import nl.b3p.brmo.schema.mapping.SimpleDateFormatAttributeColumnMapping;

import java.util.Arrays;
import java.util.HashSet;
import java.util.List;
import java.util.Set;
import java.util.stream.Collectors;
import java.util.stream.Stream;

public class BGTSchema extends Schema {
    private static BGTSchema instance;

    public static final String EIND_REGISTRATIE = &quot;eindRegistratie&quot;;

<span class="fc" id="L34">    static final Set&lt;String&gt; bgtObjectTypes =</span>
            new HashSet&lt;&gt;(
<span class="fc" id="L36">                    Arrays.asList(</span>
                            &quot;TrafficArea&quot;,
                            &quot;AuxiliaryTrafficArea&quot;,
                            &quot;Railway&quot;,
                            &quot;OnbegroeidTerreindeel&quot;,
                            &quot;PlantCover&quot;,
                            &quot;Waterdeel&quot;,
                            &quot;OndersteunendWaterdeel&quot;,
                            &quot;BuildingPart&quot;,
                            &quot;nummeraanduidingreeks&quot;, // BuildingPart one-to-many
                            // &quot;OverigeConstructie&quot;, // Wel in gegevenscatalogus, niet in LV
                            &quot;OverigBouwwerk&quot;,
                            &quot;BridgeConstructionElement&quot;,
                            &quot;TunnelPart&quot;,
                            &quot;Kunstwerkdeel&quot;,
                            &quot;Scheiding&quot;,
                            &quot;FunctioneelGebied&quot;,
                            &quot;OpenbareRuimteLabel&quot;,
                            &quot;Plaatsbepalingspunt&quot;));

<span class="fc" id="L56">    private static final List&lt;AttributeColumnMapping&gt; bgtBaseAttributes =</span>
<span class="fc" id="L57">            Arrays.asList(</span>
                    new AttributeColumnMapping(&quot;gmlId&quot;, &quot;char(32)&quot;, true, true),
                    new AttributeColumnMapping(&quot;identificatie&quot;),
                    new SimpleDateFormatAttributeColumnMapping(
                            &quot;LV-publicatiedatum&quot;, &quot;timestamp&quot;, PATTERN_XML_TIMESTAMP),
                    new SimpleDateFormatAttributeColumnMapping(
                            &quot;creationDate&quot;, &quot;date&quot;, PATTERN_XML_DATE),
                    new SimpleDateFormatAttributeColumnMapping(
                            &quot;tijdstipRegistratie&quot;, &quot;timestamp&quot;, PATTERN_XML_TIMESTAMP),
                    new SimpleDateFormatAttributeColumnMapping(
                            EIND_REGISTRATIE, &quot;timestamp&quot;, false, PATTERN_XML_TIMESTAMP),
                    new SimpleDateFormatAttributeColumnMapping(
                            &quot;terminationDate&quot;, &quot;date&quot;, false, PATTERN_XML_DATE),
                    new AttributeColumnMapping(&quot;bronhouder&quot;),
                    new BooleanAttributeColumnMapping(&quot;inOnderzoek&quot;),
                    new IntegerAttributeColumnMapping(&quot;relatieveHoogteligging&quot;),
                    new AttributeColumnMapping(&quot;bgt-status&quot;),
                    new AttributeColumnMapping(&quot;plus-status&quot;));

    private List&lt;AttributeColumnMapping&gt; withBaseAttributes(AttributeColumnMapping... attributes) {
<span class="fc" id="L77">        return Stream.concat(bgtBaseAttributes.stream(), Stream.of(attributes))</span>
<span class="fc" id="L78">                .collect(Collectors.toList());</span>
    }

    public BGTSchema() {
<span class="fc" id="L82">        super();</span>

<span class="fc" id="L84">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Bak&quot;,
<span class="fc" id="L88">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dBak&quot;, &quot;geometry(POINT, 28992)&quot;))));

<span class="fc" id="L94">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;PlantCover&quot;,
<span class="fc" id="L98">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;plus-fysiekVoorkomen&quot;),
                                new AttributeColumnMapping(&quot;class&quot;),
                                new BooleanAttributeColumnMapping(
                                        &quot;begroeidTerreindeelOpTalud&quot;, false),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dBegroeidTerreindeel&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;kruinlijnBegroeidTerreindeel&quot;))));
<span class="fc" id="L107">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Bord&quot;,
<span class="fc" id="L111">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dBord&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L116">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Buurt&quot;,
<span class="fc" id="L120">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;naam&quot;, &quot;varchar(255)&quot;, false),
                                new AttributeColumnMapping(&quot;buurtcode&quot;),
                                new AttributeColumnMapping(&quot;wijk&quot;, &quot;varchar(255)&quot;, false),
                                new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));
<span class="fc" id="L125">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;FunctioneelGebied&quot;,
<span class="fc" id="L129">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;naam&quot;, &quot;varchar(255)&quot;, false),
                                new AttributeColumnMapping(&quot;bgt-type&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dFunctioneelGebied&quot;))));
<span class="fc" id="L135">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;BuildingInstallation&quot;,
<span class="fc" id="L139">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-typeGebouwInstallatie&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dGebouwInstallatie&quot;))));
<span class="fc" id="L144">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Installatie&quot;,
<span class="fc" id="L148">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dInstallatie&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L153">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Kast&quot;,
<span class="fc" id="L157">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dKast&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L162">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Kunstwerkdeel&quot;,
<span class="fc" id="L166">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;bgt-type&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dOverigeConstructie&quot;))));
<span class="fc" id="L171">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Mast&quot;,
<span class="fc" id="L175">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dMast&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L180">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;OnbegroeidTerreindeel&quot;,
<span class="fc" id="L184">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;bgt-fysiekVoorkomen&quot;),
                                new AttributeColumnMapping(&quot;plus-fysiekVoorkomen&quot;),
                                new BooleanAttributeColumnMapping(
                                        &quot;onbegroeidTerreindeelOpTalud&quot;, false),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dOnbegroeidTerreindeel&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;kruinlijnOnbegroeidTerreindeel&quot;))));
<span class="fc" id="L193">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;OndersteunendWaterdeel&quot;,
<span class="fc" id="L197">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;class&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dOndersteunendWaterdeel&quot;))));
<span class="fc" id="L202">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;AuxiliaryTrafficArea&quot;,
<span class="fc" id="L206">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;surfaceMaterial&quot;),
                                new AttributeColumnMapping(&quot;plus-functieOndersteunendWegdeel&quot;),
                                new AttributeColumnMapping(
                                        &quot;plus-fysiekVoorkomenOndersteunendWegdeel&quot;),
                                new BooleanAttributeColumnMapping(
                                        &quot;ondersteunendWegdeelOpTalud&quot;, false),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dOndersteunendWegdeel&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;kruinlijnOndersteunendWegdeel&quot;))));
<span class="fc" id="L218">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;OngeclassificeerdObject&quot;,
<span class="fc" id="L222">                        withBaseAttributes(new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));</span>
<span class="fc" id="L223">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;OpenbareRuimte&quot;,
<span class="fc" id="L227">                        withBaseAttributes(new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));</span>
<span class="fc" id="L228">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;OpenbareRuimteLabel&quot;,
<span class="fc" id="L232">                        withBaseAttributes(</span>
                                new IntegerAttributeColumnMapping(&quot;idx&quot;, true, true),
                                new AttributeColumnMapping(&quot;tekst&quot;),
                                new DoubleAttributeColumnMapping(&quot;hoek&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;plaatsingspunt&quot;, &quot;geometry(POINT, 28992)&quot;),
                                new AttributeColumnMapping(&quot;openbareRuimteType&quot;),
                                new AttributeColumnMapping(
                                        &quot;identificatieBAGOPR&quot;, &quot;varchar(16)&quot;, false))));
<span class="fc" id="L241">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;BridgeConstructionElement&quot;,
<span class="fc" id="L245">                        withBaseAttributes(</span>
                                new BooleanAttributeColumnMapping(
                                        &quot;overbruggingIsBeweegbaar&quot;, false),
                                new AttributeColumnMapping(&quot;hoortBijTypeOverbrugging&quot;),
                                new AttributeColumnMapping(&quot;class&quot;),
                                new AttributeColumnMapping(
                                        &quot;identificatieBAGOPR&quot;, &quot;varchar(16)&quot;, false),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dOverbruggingsdeel&quot;))));
<span class="fc" id="L254">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;OverigBouwwerk&quot;,
<span class="fc" id="L258">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;bgt-type&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dOverigeConstructie&quot;))));
<span class="fc" id="L263">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;OverigeScheiding&quot;,
<span class="fc" id="L267">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;plus-type&quot;, &quot;varchar(255)&quot;, false),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dOverigeConstructie&quot;))));
<span class="fc" id="L271">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Paal&quot;,
<span class="fc" id="L275">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;, &quot;varchar(255)&quot;, false),
                                new AttributeColumnMapping(
                                        &quot;hectometeraanduiding&quot;, &quot;varchar(255)&quot;, false),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dPaal&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L282">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;BuildingPart&quot;,
<span class="fc" id="L286">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;identificatieBAGPND&quot;),
                                new OneToManyColumnMapping(&quot;nummeraanduidingreeks&quot;),
                                new GeometryAttributeColumnMapping(&quot;geometrie2dGrondvlak&quot;))));
<span class="fc" id="L290">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;nummeraanduidingreeks&quot;,
<span class="fc" id="L294">                        Arrays.asList(</span>
                                new AttributeColumnMapping(&quot;pandgmlid&quot;, &quot;varchar(255)&quot;, true, true),
                                new IntegerAttributeColumnMapping(&quot;idx&quot;, true, true),
                                new BooleanAttributeColumnMapping(&quot;pandeindregistratie&quot;, true),
                                new AttributeColumnMapping(&quot;tekst&quot;),
                                new DoubleAttributeColumnMapping(&quot;hoek&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;plaatsingspunt&quot;, &quot;geometry(POINT, 28992)&quot;),
                                new AttributeColumnMapping(
                                        &quot;identificatieBAGVBOLaagsteHuisnummer&quot;,
                                        &quot;varchar(16)&quot;,
                                        false),
                                new AttributeColumnMapping(
                                        &quot;identificatieBAGVBOHoogsteHuisnummer&quot;,
                                        &quot;varchar(16)&quot;,
                                        false))));
<span class="fc" id="L310">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Plaatsbepalingspunt&quot;,
<span class="fc" id="L314">                        Arrays.asList(</span>
                                new AttributeColumnMapping(&quot;gmlId&quot;, &quot;char(32)&quot;, true, true),
                                new AttributeColumnMapping(&quot;identificatie&quot;),
                                new IntegerAttributeColumnMapping(&quot;nauwkeurigheid&quot;, false),
                                new SimpleDateFormatAttributeColumnMapping(
                                        &quot;datumInwinning&quot;, &quot;date&quot;, true, PATTERN_XML_DATE),
                                new AttributeColumnMapping(
                                        &quot;inwinnendeInstantie&quot;, &quot;varchar(255)&quot;, false),
                                new AttributeColumnMapping(
                                        &quot;inwinningsmethode&quot;, &quot;varchar(255)&quot;, true),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L326">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Put&quot;,
<span class="fc" id="L330">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dPut&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L335">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Scheiding&quot;,
<span class="fc" id="L339">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;bgt-type&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dOverigeConstructie&quot;))));
<span class="fc" id="L344">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Sensor&quot;,
<span class="fc" id="L348">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(&quot;geometrie2dSensor&quot;))));
<span class="fc" id="L352">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Railway&quot;,
<span class="fc" id="L356">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(
                                        &quot;plus-functieSpoor&quot;, &quot;varchar(255)&quot;, false),
                                new GeometryAttributeColumnMapping(&quot;geometrie2dSpoor&quot;))));
<span class="fc" id="L361">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Stadsdeel&quot;,
<span class="fc" id="L365">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;naam&quot;, &quot;varchar(255)&quot;, false),
                                new AttributeColumnMapping(&quot;function&quot;, &quot;varchar(255)&quot;, false),
                                new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));
<span class="fc" id="L369">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Straatmeubilair&quot;,
<span class="fc" id="L373">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dStraatmeubilair&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L378">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;TunnelPart&quot;,
<span class="fc" id="L382">                        withBaseAttributes(</span>
                                new GeometryAttributeColumnMapping(&quot;geometrie2dTunneldeel&quot;))));
<span class="fc" id="L384">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;SolitaryVegetationObject&quot;,
<span class="fc" id="L388">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;class&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(&quot;geometrie2dVegetatieObject&quot;))));
<span class="fc" id="L392">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Waterdeel&quot;,
<span class="fc" id="L396">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;class&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(&quot;geometrie2dWaterdeel&quot;))));
<span class="fc" id="L400">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Waterinrichtingselement&quot;,
<span class="fc" id="L404">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dWaterinrichtingselement&quot;))));
<span class="fc" id="L409">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Waterschap&quot;,
<span class="fc" id="L413">                        withBaseAttributes(new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));</span>
<span class="fc" id="L414">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;TrafficArea&quot;,
<span class="fc" id="L418">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-functieWegdeel&quot;),
                                new AttributeColumnMapping(&quot;plus-fysiekVoorkomenWegdeel&quot;),
                                new AttributeColumnMapping(&quot;surfaceMaterial&quot;),
                                new BooleanAttributeColumnMapping(&quot;wegdeelOpTalud&quot;, false),
                                new GeometryAttributeColumnMapping(&quot;geometrie2dWegdeel&quot;),
                                new GeometryAttributeColumnMapping(&quot;kruinlijnWegdeel&quot;))));
<span class="fc" id="L426">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Weginrichtingselement&quot;,
<span class="fc" id="L430">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;function&quot;),
                                new AttributeColumnMapping(&quot;plus-type&quot;),
                                new GeometryAttributeColumnMapping(
                                        &quot;geometrie2dWeginrichtingselement&quot;))));
<span class="fc" id="L435">        addObjectType(</span>
                new BGTObjectType(
                        this,
                        &quot;Wijk&quot;,
<span class="fc" id="L439">                        withBaseAttributes(</span>
                                new AttributeColumnMapping(&quot;naam&quot;, &quot;varchar(255)&quot;, false),
                                new AttributeColumnMapping(&quot;wijkcode&quot;),
                                new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));
<span class="fc" id="L443">    }</span>

    protected void addObjectType(BGTObjectType objectType) {
<span class="fc" id="L446">        super.addObjectType(objectType);</span>
<span class="fc" id="L447">    }</span>

    public static BGTSchema getInstance() {
<span class="fc bfc" id="L450" title="All 2 branches covered.">        if (instance == null) {</span>
<span class="fc" id="L451">            instance = new BGTSchema();</span>
        }
<span class="fc" id="L453">        return instance;</span>
    }

    public Stream&lt;BGTObjectType&gt; getAllObjectTypes() {
<span class="nc" id="L457">        return (Stream&lt;BGTObjectType&gt;) super.getAllObjectTypes();</span>
    }

    public Stream&lt;BGTObjectType&gt; getOnlyBGTObjectTypes() {
<span class="nc bnc" id="L461" title="All 2 branches missed.">        return getAllObjectTypes().filter(objectType -&gt; !objectType.isIMGeoPlusType());</span>
    }

    public Stream&lt;BGTObjectType&gt; getIMGeoPlusObjectTypes() {
<span class="nc" id="L465">        return getAllObjectTypes().filter(BGTObjectType::isIMGeoPlusType);</span>
    }

    public BGTObjectType getObjectTypeByName(String name) {
<span class="fc" id="L469">        return (BGTObjectType) super.getObjectTypeByName(name);</span>
    }

    /**
     * CityGML gml:id's hebben in IMGeo bestanden soms een extra 'b' voor het UUID, blijkelijk zodat
     * in mutatiebestanden geen dubbele id attributen voorkomen. Deze methode stript de extra 'b' en
     * eventuele streepjes en maakt alles lowercase.
     */
    public static String fixUUID(final String uuidParam) {
<span class="fc" id="L478">        String uuid = uuidParam.replaceAll(&quot;-&quot;, &quot;&quot;).toLowerCase();</span>
<span class="pc bpc" id="L479" title="1 of 4 branches missed.">        if (uuid.length() == 33 &amp;&amp; uuid.charAt(0) == 'b') {</span>
<span class="fc" id="L480">            return uuid.substring(1);</span>
        }
<span class="pc bpc" id="L482" title="1 of 2 branches missed.">        if (uuid.length() != 32) {</span>
<span class="nc" id="L483">            throw new IllegalArgumentException(&quot;Invalid UUID: &quot; + uuidParam);</span>
        }
<span class="fc" id="L485">        return uuid;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>