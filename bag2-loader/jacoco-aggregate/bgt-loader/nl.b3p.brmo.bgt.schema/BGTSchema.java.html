<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>BGTSchema.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">BRMO BAG 2.0 loader</a> &gt; <a href="../index.html" class="el_bundle">bgt-loader</a> &gt; <a href="index.source.html" class="el_package">nl.b3p.brmo.bgt.schema</a> &gt; <span class="el_source">BGTSchema.java</span></div><h1>BGTSchema.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2021 B3Partners B.V.
 *
 * SPDX-License-Identifier: MIT
 *
 */

package nl.b3p.brmo.bgt.schema;

import static nl.b3p.brmo.schema.mapping.SimpleDateFormatAttributeColumnMapping.PATTERN_XML_DATE;
import static nl.b3p.brmo.schema.mapping.SimpleDateFormatAttributeColumnMapping.PATTERN_XML_TIMESTAMP;

import java.util.Arrays;
import java.util.HashSet;
import java.util.List;
import java.util.Set;
import java.util.stream.Collectors;
import java.util.stream.Stream;
import nl.b3p.brmo.schema.Schema;
import nl.b3p.brmo.schema.mapping.AttributeColumnMapping;
import nl.b3p.brmo.schema.mapping.BooleanAttributeColumnMapping;
import nl.b3p.brmo.schema.mapping.DoubleAttributeColumnMapping;
import nl.b3p.brmo.schema.mapping.GeometryAttributeColumnMapping;
import nl.b3p.brmo.schema.mapping.IntegerAttributeColumnMapping;
import nl.b3p.brmo.schema.mapping.OneToManyColumnMapping;
import nl.b3p.brmo.schema.mapping.SimpleDateFormatAttributeColumnMapping;

public class BGTSchema extends Schema {
  private static BGTSchema instance;

  public static final String EIND_REGISTRATIE = &quot;eindRegistratie&quot;;

<span class="fc" id="L33">  static final Set&lt;String&gt; bgtObjectTypes =</span>
      new HashSet&lt;&gt;(
<span class="fc" id="L35">          Arrays.asList(</span>
              &quot;TrafficArea&quot;,
              &quot;AuxiliaryTrafficArea&quot;,
              &quot;Railway&quot;,
              &quot;OnbegroeidTerreindeel&quot;,
              &quot;PlantCover&quot;,
              &quot;Waterdeel&quot;,
              &quot;OndersteunendWaterdeel&quot;,
              &quot;BuildingPart&quot;,
              &quot;nummeraanduidingreeks&quot;, // BuildingPart one-to-many
              // &quot;OverigeConstructie&quot;, // Wel in gegevenscatalogus, niet in LV
              &quot;OverigBouwwerk&quot;,
              &quot;BridgeConstructionElement&quot;,
              &quot;TunnelPart&quot;,
              &quot;Kunstwerkdeel&quot;,
              &quot;Scheiding&quot;,
              &quot;FunctioneelGebied&quot;,
              &quot;OpenbareRuimteLabel&quot;,
              &quot;Plaatsbepalingspunt&quot;));

<span class="fc" id="L55">  private static final List&lt;AttributeColumnMapping&gt; bgtBaseAttributes =</span>
<span class="fc" id="L56">      Arrays.asList(</span>
          new AttributeColumnMapping(&quot;gmlId&quot;, &quot;char(32)&quot;, true, true),
          new AttributeColumnMapping(&quot;identificatie&quot;),
          new SimpleDateFormatAttributeColumnMapping(
              &quot;LV-publicatiedatum&quot;, &quot;timestamp&quot;, PATTERN_XML_TIMESTAMP),
          new SimpleDateFormatAttributeColumnMapping(&quot;creationDate&quot;, &quot;date&quot;, PATTERN_XML_DATE),
          new SimpleDateFormatAttributeColumnMapping(
              &quot;tijdstipRegistratie&quot;, &quot;timestamp&quot;, PATTERN_XML_TIMESTAMP),
          new SimpleDateFormatAttributeColumnMapping(
              EIND_REGISTRATIE, &quot;timestamp&quot;, false, PATTERN_XML_TIMESTAMP),
          new SimpleDateFormatAttributeColumnMapping(
              &quot;terminationDate&quot;, &quot;date&quot;, false, PATTERN_XML_DATE),
          new AttributeColumnMapping(&quot;bronhouder&quot;),
          new BooleanAttributeColumnMapping(&quot;inOnderzoek&quot;),
          new IntegerAttributeColumnMapping(&quot;relatieveHoogteligging&quot;),
          new AttributeColumnMapping(&quot;bgt-status&quot;),
          new AttributeColumnMapping(&quot;plus-status&quot;));

  private List&lt;AttributeColumnMapping&gt; withBaseAttributes(AttributeColumnMapping... attributes) {
<span class="fc" id="L75">    return Stream.concat(bgtBaseAttributes.stream(), Stream.of(attributes))</span>
<span class="fc" id="L76">        .collect(Collectors.toList());</span>
  }

  public BGTSchema() {
<span class="fc" id="L80">    super();</span>

<span class="fc" id="L82">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Bak&quot;,
<span class="fc" id="L86">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dBak&quot;, &quot;geometry(POINT, 28992)&quot;))));

<span class="fc" id="L91">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;PlantCover&quot;,
<span class="fc" id="L95">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;plus-fysiekVoorkomen&quot;),
                new AttributeColumnMapping(&quot;class&quot;),
                new BooleanAttributeColumnMapping(&quot;begroeidTerreindeelOpTalud&quot;, false),
                new GeometryAttributeColumnMapping(&quot;geometrie2dBegroeidTerreindeel&quot;),
                new GeometryAttributeColumnMapping(&quot;kruinlijnBegroeidTerreindeel&quot;))));
<span class="fc" id="L101">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Bord&quot;,
<span class="fc" id="L105">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dBord&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L109">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Buurt&quot;,
<span class="fc" id="L113">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;naam&quot;, &quot;varchar(255)&quot;, false),
                new AttributeColumnMapping(&quot;buurtcode&quot;),
                new AttributeColumnMapping(&quot;wijk&quot;, &quot;varchar(255)&quot;, false),
                new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));
<span class="fc" id="L118">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;FunctioneelGebied&quot;,
<span class="fc" id="L122">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;naam&quot;, &quot;varchar(255)&quot;, false),
                new AttributeColumnMapping(&quot;bgt-type&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dFunctioneelGebied&quot;))));
<span class="fc" id="L127">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;BuildingInstallation&quot;,
<span class="fc" id="L131">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-typeGebouwInstallatie&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dGebouwInstallatie&quot;))));
<span class="fc" id="L135">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Installatie&quot;,
<span class="fc" id="L139">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(
                    &quot;geometrie2dInstallatie&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L144">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Kast&quot;,
<span class="fc" id="L148">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dKast&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L152">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Kunstwerkdeel&quot;,
<span class="fc" id="L156">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;bgt-type&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dOverigeConstructie&quot;))));
<span class="fc" id="L160">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Mast&quot;,
<span class="fc" id="L164">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dMast&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L168">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;OnbegroeidTerreindeel&quot;,
<span class="fc" id="L172">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;bgt-fysiekVoorkomen&quot;),
                new AttributeColumnMapping(&quot;plus-fysiekVoorkomen&quot;),
                new BooleanAttributeColumnMapping(&quot;onbegroeidTerreindeelOpTalud&quot;, false),
                new GeometryAttributeColumnMapping(&quot;geometrie2dOnbegroeidTerreindeel&quot;),
                new GeometryAttributeColumnMapping(&quot;kruinlijnOnbegroeidTerreindeel&quot;))));
<span class="fc" id="L178">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;OndersteunendWaterdeel&quot;,
<span class="fc" id="L182">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;class&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dOndersteunendWaterdeel&quot;))));
<span class="fc" id="L186">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;AuxiliaryTrafficArea&quot;,
<span class="fc" id="L190">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;surfaceMaterial&quot;),
                new AttributeColumnMapping(&quot;plus-functieOndersteunendWegdeel&quot;),
                new AttributeColumnMapping(&quot;plus-fysiekVoorkomenOndersteunendWegdeel&quot;),
                new BooleanAttributeColumnMapping(&quot;ondersteunendWegdeelOpTalud&quot;, false),
                new GeometryAttributeColumnMapping(&quot;geometrie2dOndersteunendWegdeel&quot;),
                new GeometryAttributeColumnMapping(&quot;kruinlijnOndersteunendWegdeel&quot;))));
<span class="fc" id="L198">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;OngeclassificeerdObject&quot;,
<span class="fc" id="L202">            withBaseAttributes(new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));</span>
<span class="fc" id="L203">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;OpenbareRuimte&quot;,
<span class="fc" id="L207">            withBaseAttributes(new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));</span>
<span class="fc" id="L208">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;OpenbareRuimteLabel&quot;,
<span class="fc" id="L212">            withBaseAttributes(</span>
                new IntegerAttributeColumnMapping(&quot;idx&quot;, true, true),
                new AttributeColumnMapping(&quot;tekst&quot;),
                new DoubleAttributeColumnMapping(&quot;hoek&quot;),
                new GeometryAttributeColumnMapping(&quot;plaatsingspunt&quot;, &quot;geometry(POINT, 28992)&quot;),
                new AttributeColumnMapping(&quot;openbareRuimteType&quot;),
                new AttributeColumnMapping(&quot;identificatieBAGOPR&quot;, &quot;varchar(16)&quot;, false))));
<span class="fc" id="L219">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;BridgeConstructionElement&quot;,
<span class="fc" id="L223">            withBaseAttributes(</span>
                new BooleanAttributeColumnMapping(&quot;overbruggingIsBeweegbaar&quot;, false),
                new AttributeColumnMapping(&quot;hoortBijTypeOverbrugging&quot;),
                new AttributeColumnMapping(&quot;class&quot;),
                new AttributeColumnMapping(&quot;identificatieBAGOPR&quot;, &quot;varchar(16)&quot;, false),
                new GeometryAttributeColumnMapping(&quot;geometrie2dOverbruggingsdeel&quot;))));
<span class="fc" id="L229">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;OverigBouwwerk&quot;,
<span class="fc" id="L233">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;bgt-type&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dOverigeConstructie&quot;))));
<span class="fc" id="L237">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;OverigeScheiding&quot;,
<span class="fc" id="L241">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;plus-type&quot;, &quot;varchar(255)&quot;, false),
                new GeometryAttributeColumnMapping(&quot;geometrie2dOverigeConstructie&quot;))));
<span class="fc" id="L244">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Paal&quot;,
<span class="fc" id="L248">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;, &quot;varchar(255)&quot;, false),
                new AttributeColumnMapping(&quot;hectometeraanduiding&quot;, &quot;varchar(255)&quot;, false),
                new GeometryAttributeColumnMapping(&quot;geometrie2dPaal&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L253">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;BuildingPart&quot;,
<span class="fc" id="L257">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;identificatieBAGPND&quot;),
                new OneToManyColumnMapping(&quot;nummeraanduidingreeks&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dGrondvlak&quot;))));
<span class="fc" id="L261">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;nummeraanduidingreeks&quot;,
<span class="fc" id="L265">            Arrays.asList(</span>
                new AttributeColumnMapping(&quot;pandgmlid&quot;, &quot;varchar(255)&quot;, true, true),
                new IntegerAttributeColumnMapping(&quot;idx&quot;, true, true),
                new BooleanAttributeColumnMapping(&quot;pandeindregistratie&quot;, true),
                new AttributeColumnMapping(&quot;tekst&quot;),
                new DoubleAttributeColumnMapping(&quot;hoek&quot;),
                new GeometryAttributeColumnMapping(&quot;plaatsingspunt&quot;, &quot;geometry(POINT, 28992)&quot;),
                new AttributeColumnMapping(
                    &quot;identificatieBAGVBOLaagsteHuisnummer&quot;, &quot;varchar(16)&quot;, false),
                new AttributeColumnMapping(
                    &quot;identificatieBAGVBOHoogsteHuisnummer&quot;, &quot;varchar(16)&quot;, false))));
<span class="fc" id="L276">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Plaatsbepalingspunt&quot;,
<span class="fc" id="L280">            Arrays.asList(</span>
                new AttributeColumnMapping(&quot;gmlId&quot;, &quot;char(32)&quot;, true, true),
                new AttributeColumnMapping(&quot;identificatie&quot;),
                new IntegerAttributeColumnMapping(&quot;nauwkeurigheid&quot;, false),
                new SimpleDateFormatAttributeColumnMapping(
                    &quot;datumInwinning&quot;, &quot;date&quot;, true, PATTERN_XML_DATE),
                new AttributeColumnMapping(&quot;inwinnendeInstantie&quot;, &quot;varchar(255)&quot;, false),
                new AttributeColumnMapping(&quot;inwinningsmethode&quot;, &quot;varchar(255)&quot;, true),
                new GeometryAttributeColumnMapping(&quot;geometrie&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L289">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Put&quot;,
<span class="fc" id="L293">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dPut&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L297">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Scheiding&quot;,
<span class="fc" id="L301">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;bgt-type&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dOverigeConstructie&quot;))));
<span class="fc" id="L305">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Sensor&quot;,
<span class="fc" id="L309">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dSensor&quot;))));
<span class="fc" id="L313">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Railway&quot;,
<span class="fc" id="L317">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-functieSpoor&quot;, &quot;varchar(255)&quot;, false),
                new GeometryAttributeColumnMapping(&quot;geometrie2dSpoor&quot;))));
<span class="fc" id="L321">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Stadsdeel&quot;,
<span class="fc" id="L325">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;naam&quot;, &quot;varchar(255)&quot;, false),
                new AttributeColumnMapping(&quot;function&quot;, &quot;varchar(255)&quot;, false),
                new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));
<span class="fc" id="L329">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Straatmeubilair&quot;,
<span class="fc" id="L333">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(
                    &quot;geometrie2dStraatmeubilair&quot;, &quot;geometry(POINT, 28992)&quot;))));
<span class="fc" id="L338">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;TunnelPart&quot;,
<span class="fc" id="L342">            withBaseAttributes(new GeometryAttributeColumnMapping(&quot;geometrie2dTunneldeel&quot;))));</span>
<span class="fc" id="L343">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;SolitaryVegetationObject&quot;,
<span class="fc" id="L347">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;class&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dVegetatieObject&quot;))));
<span class="fc" id="L351">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Waterdeel&quot;,
<span class="fc" id="L355">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;class&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dWaterdeel&quot;))));
<span class="fc" id="L359">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Waterinrichtingselement&quot;,
<span class="fc" id="L363">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dWaterinrichtingselement&quot;))));
<span class="fc" id="L367">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Waterschap&quot;,
<span class="fc" id="L371">            withBaseAttributes(new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));</span>
<span class="fc" id="L372">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;TrafficArea&quot;,
<span class="fc" id="L376">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-functieWegdeel&quot;),
                new AttributeColumnMapping(&quot;plus-fysiekVoorkomenWegdeel&quot;),
                new AttributeColumnMapping(&quot;surfaceMaterial&quot;),
                new BooleanAttributeColumnMapping(&quot;wegdeelOpTalud&quot;, false),
                new GeometryAttributeColumnMapping(&quot;geometrie2dWegdeel&quot;),
                new GeometryAttributeColumnMapping(&quot;kruinlijnWegdeel&quot;))));
<span class="fc" id="L384">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Weginrichtingselement&quot;,
<span class="fc" id="L388">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;function&quot;),
                new AttributeColumnMapping(&quot;plus-type&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2dWeginrichtingselement&quot;))));
<span class="fc" id="L392">    addObjectType(</span>
        new BGTObjectType(
            this,
            &quot;Wijk&quot;,
<span class="fc" id="L396">            withBaseAttributes(</span>
                new AttributeColumnMapping(&quot;naam&quot;, &quot;varchar(255)&quot;, false),
                new AttributeColumnMapping(&quot;wijkcode&quot;),
                new GeometryAttributeColumnMapping(&quot;geometrie2d&quot;))));
<span class="fc" id="L400">  }</span>

  protected void addObjectType(BGTObjectType objectType) {
<span class="fc" id="L403">    super.addObjectType(objectType);</span>
<span class="fc" id="L404">  }</span>

  public static BGTSchema getInstance() {
<span class="fc bfc" id="L407" title="All 2 branches covered.">    if (instance == null) {</span>
<span class="fc" id="L408">      instance = new BGTSchema();</span>
    }
<span class="fc" id="L410">    return instance;</span>
  }

  @Override
  public Stream&lt;BGTObjectType&gt; getAllObjectTypes() {
<span class="fc" id="L415">    return (Stream&lt;BGTObjectType&gt;) super.getAllObjectTypes();</span>
  }

  public Stream&lt;BGTObjectType&gt; getOnlyBGTObjectTypes() {
<span class="nc bnc" id="L419" title="All 2 branches missed.">    return getAllObjectTypes().filter(objectType -&gt; !objectType.isIMGeoPlusType());</span>
  }

  public Stream&lt;BGTObjectType&gt; getIMGeoPlusObjectTypes() {
<span class="nc" id="L423">    return getAllObjectTypes().filter(BGTObjectType::isIMGeoPlusType);</span>
  }

  @Override
  public BGTObjectType getObjectTypeByName(String name) {
<span class="fc" id="L428">    return (BGTObjectType) super.getObjectTypeByName(name);</span>
  }

  /**
   * CityGML gml:id's hebben in IMGeo bestanden soms een extra 'b' voor het UUID, blijkelijk zodat
   * in mutatiebestanden geen dubbele id attributen voorkomen. Deze methode stript de extra 'b' en
   * eventuele streepjes en maakt alles lowercase.
   */
  public static String fixUUID(final String uuidParam) {
<span class="fc" id="L437">    String uuid = uuidParam.replaceAll(&quot;-&quot;, &quot;&quot;).toLowerCase();</span>
<span class="pc bpc" id="L438" title="1 of 4 branches missed.">    if (uuid.length() == 33 &amp;&amp; uuid.charAt(0) == 'b') {</span>
<span class="fc" id="L439">      return uuid.substring(1);</span>
    }
<span class="pc bpc" id="L441" title="1 of 2 branches missed.">    if (uuid.length() != 32) {</span>
<span class="nc" id="L442">      throw new IllegalArgumentException(&quot;Invalid UUID: &quot; + uuidParam);</span>
    }
<span class="fc" id="L444">    return uuid;</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>