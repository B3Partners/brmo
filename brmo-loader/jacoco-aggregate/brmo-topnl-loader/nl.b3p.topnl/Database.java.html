<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>Database.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">BRMO loader</a> &gt; <a href="../index.html" class="el_bundle">brmo-topnl-loader</a> &gt; <a href="index.source.html" class="el_package">nl.b3p.topnl</a> &gt; <span class="el_source">Database.java</span></div><h1>Database.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2016 - 2017 B3Partners B.V.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
 */
package nl.b3p.topnl;

import java.sql.SQLException;
import javax.sql.DataSource;
import nl.b3p.jdbc.util.converter.GeometryJdbcConverter;
import nl.b3p.jdbc.util.converter.GeometryJdbcConverterFactory;
import nl.b3p.topnl.converters.DbUtilsGeometryColumnConverter;
import nl.b3p.topnl.entities.FunctioneelGebied;
import nl.b3p.topnl.entities.Gebouw;
import nl.b3p.topnl.entities.GeografischGebied;
import nl.b3p.topnl.entities.Hoogte;
import nl.b3p.topnl.entities.Inrichtingselement;
import nl.b3p.topnl.entities.Plaats;
import nl.b3p.topnl.entities.PlanTopografie;
import nl.b3p.topnl.entities.RegistratiefGebied;
import nl.b3p.topnl.entities.Relief;
import nl.b3p.topnl.entities.Spoorbaandeel;
import nl.b3p.topnl.entities.Terrein;
import nl.b3p.topnl.entities.TopNLEntity;
import nl.b3p.topnl.entities.Waterdeel;
import nl.b3p.topnl.entities.Wegdeel;
import org.apache.commons.dbutils.BasicRowProcessor;
import org.apache.commons.dbutils.QueryRunner;
import org.apache.commons.dbutils.ResultSetHandler;
import org.apache.commons.dbutils.handlers.BeanHandler;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.locationtech.jts.io.ParseException;

/**
 * @author Meine Toonen meinetoonen@b3partners.nl
 */
public class Database {

<span class="fc" id="L51">  protected static final Log log = LogFactory.getLog(Database.class);</span>

  private final DataSource dataSource;
  private GeometryJdbcConverter gjc;
  private QueryRunner run;

<span class="fc" id="L57">  public Database(DataSource ds) throws SQLException {</span>
<span class="fc" id="L58">    this.dataSource = ds;</span>
<span class="fc bfc" id="L59" title="All 2 branches covered.">    if (ds != null) {</span>
<span class="fc" id="L60">      gjc = GeometryJdbcConverterFactory.getGeometryJdbcConverter(dataSource.getConnection());</span>
<span class="fc" id="L61">      run = new QueryRunner(dataSource, gjc.isPmdKnownBroken());</span>
    }
<span class="fc" id="L63">  }</span>

  public void save(TopNLEntity entity) throws ParseException, SQLException {

    try {

<span class="fc bfc" id="L69" title="All 2 branches covered.">      if (entity instanceof Hoogte) {</span>
<span class="fc" id="L70">        saveHoogte(entity);</span>
<span class="fc bfc" id="L71" title="All 2 branches covered.">      } else if (entity instanceof FunctioneelGebied) {</span>
<span class="fc" id="L72">        saveFunctioneelGebied(entity);</span>
<span class="fc bfc" id="L73" title="All 2 branches covered.">      } else if (entity instanceof Gebouw) {</span>
<span class="fc" id="L74">        saveGebouw(entity);</span>
<span class="fc bfc" id="L75" title="All 2 branches covered.">      } else if (entity instanceof GeografischGebied) {</span>
<span class="fc" id="L76">        saveGeografischGebied(entity);</span>
<span class="fc bfc" id="L77" title="All 2 branches covered.">      } else if (entity instanceof Inrichtingselement) {</span>
<span class="fc" id="L78">        saveInrichtingselement(entity);</span>
<span class="fc bfc" id="L79" title="All 2 branches covered.">      } else if (entity instanceof Plaats) {</span>
<span class="fc" id="L80">        savePlaats(entity);</span>
<span class="fc bfc" id="L81" title="All 2 branches covered.">      } else if (entity instanceof RegistratiefGebied) {</span>
<span class="fc" id="L82">        saveRegistratiefGebied(entity);</span>
<span class="fc bfc" id="L83" title="All 2 branches covered.">      } else if (entity instanceof Relief) {</span>
<span class="fc" id="L84">        saveRelief(entity);</span>
<span class="fc bfc" id="L85" title="All 2 branches covered.">      } else if (entity instanceof Spoorbaandeel) {</span>
<span class="fc" id="L86">        saveSpoorbaandeel(entity);</span>
<span class="fc bfc" id="L87" title="All 2 branches covered.">      } else if (entity instanceof Terrein) {</span>
<span class="fc" id="L88">        saveTerrein(entity);</span>
<span class="fc bfc" id="L89" title="All 2 branches covered.">      } else if (entity instanceof Waterdeel) {</span>
<span class="fc" id="L90">        saveWaterdeel(entity);</span>
<span class="fc bfc" id="L91" title="All 2 branches covered.">      } else if (entity instanceof Wegdeel) {</span>
<span class="fc" id="L92">        saveWegdeel(entity);</span>
<span class="pc bpc" id="L93" title="1 of 2 branches missed.">      } else if (entity instanceof PlanTopografie) {</span>
<span class="fc" id="L94">        savePlanTopografie(entity);</span>
      } else {
<span class="nc" id="L96">        throw new IllegalArgumentException(&quot;Type of entity not (yet) implemented.&quot;);</span>
      }

<span class="nc" id="L99">    } catch (SQLException e) {</span>
<span class="nc" id="L100">      log.error(&quot;Error inserting entity: &quot;, e);</span>
<span class="nc" id="L101">      throw e;</span>
<span class="fc" id="L102">    }</span>
<span class="fc" id="L103">  }</span>

  private Gebouw saveGebouw(TopNLEntity entity) throws SQLException, ParseException {
<span class="fc" id="L106">    Gebouw h = (Gebouw) entity;</span>

<span class="fc" id="L108">    ResultSetHandler&lt;Gebouw&gt; handler =</span>
        new BeanHandler(
            Gebouw.class, new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L111">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L112">    Object[] args =</span>
<span class="fc" id="L113">        getVarargs(</span>
            entity,
<span class="fc" id="L115">            h.getTypeGebouw(),</span>
<span class="fc" id="L116">            h.getStatus(),</span>
<span class="fc" id="L117">            h.getFysiekVoorkomen(),</span>
<span class="fc" id="L118">            h.getHoogteklasse(),</span>
<span class="fc" id="L119">            h.getHoogte(),</span>
<span class="fc" id="L120">            h.getSoortnaam(),</span>
<span class="fc" id="L121">            h.getNaam(),</span>
<span class="fc" id="L122">            h.getNaamFries(),</span>
            nativeGeom);
<span class="fc" id="L124">    Gebouw inserted =</span>
<span class="fc" id="L125">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L127">                + h.getTopnltype()</span>
                + &quot;.gebouw (&quot;
<span class="fc" id="L129">                + getTopNLEntityColumns()</span>
                + &quot;,typegebouw,status,fysiekvoorkomen,hoogteklasse,hoogte,soortnaam,naam,naamfries,geometrie) VALUES (&quot;
<span class="fc" id="L131">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?,?,?,?,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L136">    return inserted;</span>
  }

  private PlanTopografie savePlanTopografie(TopNLEntity entity)
      throws SQLException, ParseException {
<span class="fc" id="L141">    PlanTopografie h = (PlanTopografie) entity;</span>

<span class="fc" id="L143">    ResultSetHandler&lt;PlanTopografie&gt; handler =</span>
        new BeanHandler(
            PlanTopografie.class, new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L146">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L147">    Object[] args = getVarargs(entity, h.getTypePlanTopografie(), h.getNaam(), nativeGeom);</span>
<span class="fc" id="L148">    PlanTopografie inserted =</span>
<span class="fc" id="L149">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L151">                + h.getTopnltype()</span>
                + &quot;.PlanTopoGrafie (&quot;
<span class="fc" id="L153">                + getTopNLEntityColumns()</span>
                + &quot;,typePlanTopografie,naam,geometrie) VALUES (&quot;
<span class="fc" id="L155">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L160">    return inserted;</span>
  }

  private GeografischGebied saveGeografischGebied(TopNLEntity entity)
      throws SQLException, ParseException {
<span class="fc" id="L165">    GeografischGebied h = (GeografischGebied) entity;</span>

<span class="fc" id="L167">    ResultSetHandler&lt;GeografischGebied&gt; handler =</span>
        new BeanHandler(
            GeografischGebied.class,
            new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L171">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L172">    Object[] args =</span>
<span class="fc" id="L173">        getVarargs(</span>
<span class="fc" id="L174">            entity, h.getTypeGeografischGebied(), h.getNaamNL(), h.getNaamFries(), nativeGeom);</span>
<span class="fc" id="L175">    GeografischGebied inserted =</span>
<span class="fc" id="L176">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L178">                + h.getTopnltype()</span>
                + &quot;.geografischgebied (&quot;
<span class="fc" id="L180">                + getTopNLEntityColumns()</span>
                + &quot;,typeGeografischGebied,naamNL,naamFries,geometrie) VALUES (&quot;
<span class="fc" id="L182">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L187">    return inserted;</span>
  }

  private Inrichtingselement saveInrichtingselement(TopNLEntity entity)
      throws SQLException, ParseException {
<span class="fc" id="L192">    Inrichtingselement h = (Inrichtingselement) entity;</span>

<span class="fc" id="L194">    ResultSetHandler&lt;Inrichtingselement&gt; handler =</span>
        new BeanHandler(
            Inrichtingselement.class,
            new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L198">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L199">    Object[] args =</span>
<span class="fc" id="L200">        getVarargs(</span>
            entity,
<span class="fc" id="L202">            h.getTypeInrichtingselement(),</span>
<span class="fc" id="L203">            h.getSoortnaam(),</span>
<span class="fc" id="L204">            h.getStatus(),</span>
<span class="fc" id="L205">            h.getHoogteniveau(),</span>
            nativeGeom);
<span class="fc" id="L207">    Inrichtingselement inserted =</span>
<span class="fc" id="L208">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L210">                + h.getTopnltype()</span>
                + &quot;.inrichtingselement (&quot;
<span class="fc" id="L212">                + getTopNLEntityColumns()</span>
                + &quot;,typeInrichtingselement,soortnaam,status,hoogteniveau,geometrie) VALUES (&quot;
<span class="fc" id="L214">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L219">    return inserted;</span>
  }

  private Plaats savePlaats(TopNLEntity entity) throws SQLException, ParseException {
<span class="fc" id="L223">    Plaats h = (Plaats) entity;</span>

<span class="fc" id="L225">    ResultSetHandler&lt;Plaats&gt; handler =</span>
        new BeanHandler(
            Plaats.class, new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L228">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L229">    Object[] args =</span>
<span class="fc" id="L230">        getVarargs(</span>
            entity,
<span class="fc" id="L232">            h.getTypeGebied(),</span>
<span class="fc" id="L233">            h.getAantalInwoners(),</span>
<span class="fc" id="L234">            h.getNaamOfficieel(),</span>
<span class="fc" id="L235">            h.getNaamNL(),</span>
<span class="fc" id="L236">            h.getNaamFries(),</span>
            nativeGeom);
<span class="fc" id="L238">    Plaats inserted =</span>
<span class="fc" id="L239">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L241">                + h.getTopnltype()</span>
                + &quot;.plaats (&quot;
<span class="fc" id="L243">                + getTopNLEntityColumns()</span>
                + &quot;,typeGebied,aantalInwoners,naamOfficieel,naamNL,naamFries,geometrie) VALUES (&quot;
<span class="fc" id="L245">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L250">    return inserted;</span>
  }

  private RegistratiefGebied saveRegistratiefGebied(TopNLEntity entity)
      throws SQLException, ParseException {
<span class="fc" id="L255">    RegistratiefGebied h = (RegistratiefGebied) entity;</span>

<span class="fc" id="L257">    ResultSetHandler&lt;RegistratiefGebied&gt; handler =</span>
        new BeanHandler(
            RegistratiefGebied.class,
            new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L261">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L262">    Object[] args =</span>
<span class="fc" id="L263">        getVarargs(</span>
            entity,
<span class="fc" id="L265">            h.getTypeRegistratiefGebied(),</span>
<span class="fc" id="L266">            h.getNaamOfficieel(),</span>
<span class="fc" id="L267">            h.getNaamNL(),</span>
<span class="fc" id="L268">            h.getNaamFries(),</span>
<span class="fc" id="L269">            h.getNummer(),</span>
            nativeGeom);
<span class="fc" id="L271">    RegistratiefGebied inserted =</span>
<span class="fc" id="L272">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L274">                + h.getTopnltype()</span>
                + &quot;.registratiefgebied (&quot;
<span class="fc" id="L276">                + getTopNLEntityColumns()</span>
                + &quot;,typeRegistratiefGebied,naamOfficieel,naamNL,naamFries,nummer,geometrie) VALUES (&quot;
<span class="fc" id="L278">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L283">    return inserted;</span>
  }

  private Relief saveRelief(TopNLEntity entity) throws SQLException, ParseException {
<span class="fc" id="L287">    Relief h = (Relief) entity;</span>

<span class="fc" id="L289">    ResultSetHandler&lt;Relief&gt; handler =</span>
        new BeanHandler(
            Relief.class, new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L292">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L293">    Object nativeLageZijde = gjc.convertToNativeGeometryObject(h.getTaludLageZijde());</span>
<span class="fc" id="L294">    Object nativeHogeZijde = gjc.convertToNativeGeometryObject(h.getTaludHogeZijde());</span>
<span class="fc" id="L295">    Object[] args =</span>
<span class="fc" id="L296">        getVarargs(</span>
            entity,
<span class="fc" id="L298">            h.getTypeRelief(),</span>
<span class="fc" id="L299">            h.getHoogteklasse(),</span>
<span class="fc" id="L300">            h.getHoogteniveau(),</span>
            nativeGeom,
            nativeLageZijde,
            nativeHogeZijde);
<span class="fc" id="L304">    Relief inserted =</span>
<span class="fc" id="L305">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L307">                + h.getTopnltype()</span>
                + &quot;.relief (&quot;
<span class="fc" id="L309">                + getTopNLEntityColumns()</span>
                + &quot;,typeRelief,hoogteklasse,hoogteniveau,geometrie,taludLageZijde,taludHogeZijde) VALUES (&quot;
<span class="fc" id="L311">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L316">    return inserted;</span>
  }

  private Spoorbaandeel saveSpoorbaandeel(TopNLEntity entity) throws SQLException, ParseException {
<span class="fc" id="L320">    Spoorbaandeel h = (Spoorbaandeel) entity;</span>

<span class="fc" id="L322">    ResultSetHandler&lt;Spoorbaandeel&gt; handler =</span>
        new BeanHandler(
            Spoorbaandeel.class, new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L325">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L326">    Object[] args =</span>
<span class="fc" id="L327">        getVarargs(</span>
            entity,
<span class="fc" id="L329">            h.getTypeInfrastructuur(),</span>
<span class="fc" id="L330">            h.getTypeSpoorbaan(),</span>
<span class="fc" id="L331">            h.getFysiekVoorkomen(),</span>
<span class="fc" id="L332">            h.getSpoorbreedte(),</span>
<span class="fc" id="L333">            h.getAantalSporen(),</span>
<span class="fc" id="L334">            h.getVervoerfunctie(),</span>
<span class="fc" id="L335">            h.getElektrificatie(),</span>
<span class="fc" id="L336">            h.getStatus(),</span>
<span class="fc" id="L337">            h.getBrugnaam(),</span>
<span class="fc" id="L338">            h.getTunnelnaam(),</span>
<span class="fc" id="L339">            h.getBaanvaknaam(),</span>
<span class="fc" id="L340">            h.getHoogteniveau(),</span>
            nativeGeom);
<span class="fc" id="L342">    Spoorbaandeel inserted =</span>
<span class="fc" id="L343">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L345">                + h.getTopnltype()</span>
                + &quot;.spoorbaandeel (&quot;
<span class="fc" id="L347">                + getTopNLEntityColumns()</span>
                + &quot;,typeInfrastructuur,typeSpoorbaan,fysiekVoorkomen,spoorbreedte,aantalSporen,vervoerfunctie,elektrificatie,status,brugnaam,tunnelnaam,baanvaknaam,hoogteniveau,geometrie) VALUES (&quot;
<span class="fc" id="L349">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?,?,?,?,?,?,?,?,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L354">    return inserted;</span>
  }

  private Terrein saveTerrein(TopNLEntity entity) throws SQLException, ParseException {
<span class="fc" id="L358">    Terrein h = (Terrein) entity;</span>

<span class="fc" id="L360">    ResultSetHandler&lt;Terrein&gt; handler =</span>
        new BeanHandler(
            Terrein.class, new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L363">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L364">    Object[] args = getVarargs(entity, h.getTypeLandgebruik(), h.getNaam(), nativeGeom);</span>
<span class="fc" id="L365">    Terrein inserted =</span>
<span class="fc" id="L366">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L368">                + h.getTopnltype()</span>
                + &quot;.terrein (&quot;
<span class="fc" id="L370">                + getTopNLEntityColumns()</span>
                + &quot;,typelandgebruik,naam,geometrie) VALUES (&quot;
<span class="fc" id="L372">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L377">    return inserted;</span>
  }

  private Waterdeel saveWaterdeel(TopNLEntity entity) throws SQLException, ParseException {
<span class="fc" id="L381">    Waterdeel h = (Waterdeel) entity;</span>

<span class="fc" id="L383">    ResultSetHandler&lt;Waterdeel&gt; handler =</span>
        new BeanHandler(
            Waterdeel.class, new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L386">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>

<span class="fc" id="L388">    Object[] args =</span>
<span class="fc" id="L389">        getVarargs(</span>
            entity,
<span class="fc" id="L391">            h.getTypeWater(),</span>
<span class="fc" id="L392">            h.getBreedteklasse(),</span>
<span class="fc" id="L393">            h.getFysiekVoorkomen(),</span>
<span class="fc" id="L394">            h.getVoorkomen(),</span>
<span class="fc" id="L395">            h.getGetijdeinvloed(),</span>
<span class="fc" id="L396">            h.getVaarwegklasse(),</span>
<span class="fc" id="L397">            h.getNaamOfficieel(),</span>
<span class="fc" id="L398">            h.getNaamNL(),</span>
<span class="fc" id="L399">            h.getNaamFries(),</span>
<span class="fc" id="L400">            h.getIsBAGnaam(),</span>
<span class="fc" id="L401">            h.getSluisnaam(),</span>
<span class="fc" id="L402">            h.getBrugnaam(),</span>
<span class="fc" id="L403">            h.getHoogteniveau(),</span>
<span class="fc" id="L404">            h.getFunctie(),</span>
<span class="fc" id="L405">            h.isHoofdAfwatering(),</span>
            nativeGeom);
<span class="fc" id="L407">    Waterdeel inserted =</span>
<span class="fc" id="L408">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L410">                + h.getTopnltype()</span>
                + &quot;.waterdeel (&quot;
<span class="fc" id="L412">                + getTopNLEntityColumns()</span>
                + &quot;,typewater,breedteklasse,fysiekvoorkomen,voorkomen,getijdeinvloed,vaarwegklasse,naamofficieel,naamnl,naamfries,isbagnaam,sluisnaam,brugnaam,hoogteniveau,functie,hoofdAfwatering,geometrie) VALUES (&quot;
<span class="fc" id="L414">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L419">    return inserted;</span>
  }

  private Wegdeel saveWegdeel(TopNLEntity entity) throws SQLException, ParseException {
<span class="fc" id="L423">    Wegdeel h = (Wegdeel) entity;</span>

<span class="fc" id="L425">    ResultSetHandler&lt;Wegdeel&gt; handler =</span>
        new BeanHandler(
            Wegdeel.class, new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L428">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L429">    Object nativeHartGeom = gjc.convertToNativeGeometryObject(h.getHartGeometrie());</span>
<span class="fc" id="L430">    Object[] args =</span>
<span class="fc" id="L431">        getVarargs(</span>
            entity,
<span class="fc" id="L433">            h.getTypeInfrastructuur(),</span>
<span class="fc" id="L434">            h.getTypeWeg(),</span>
<span class="fc" id="L435">            h.getHoofdverkeersgebruik(),</span>
<span class="fc" id="L436">            h.getFysiekVoorkomen(),</span>
<span class="fc" id="L437">            h.getVerhardingsbreedteklasse(),</span>
<span class="fc" id="L438">            h.getGescheidenRijbaan(),</span>
<span class="fc" id="L439">            h.getVerhardingstype(),</span>
<span class="fc" id="L440">            h.getAantalRijstroken(),</span>
<span class="fc" id="L441">            h.getHoogteniveau(),</span>
<span class="fc" id="L442">            h.getStatus(),</span>
<span class="fc" id="L443">            h.getNaam(),</span>
<span class="fc" id="L444">            h.getIsBAGnaam(),</span>
<span class="fc" id="L445">            h.getaWegnummer(),</span>
<span class="fc" id="L446">            h.getnWegnummer(),</span>
<span class="fc" id="L447">            h.geteWegnummer(),</span>
<span class="fc" id="L448">            h.getsWegnummer(),</span>
<span class="fc" id="L449">            h.getAfritnummer(),</span>
<span class="fc" id="L450">            h.getAfritnaam(),</span>
<span class="fc" id="L451">            h.getKnooppuntnaam(),</span>
<span class="fc" id="L452">            h.getBrugnaam(),</span>
<span class="fc" id="L453">            h.getTunnelnaam(),</span>
            nativeHartGeom,
            nativeGeom);
<span class="fc" id="L456">    String query =</span>
        &quot;INSERT INTO &quot;
<span class="fc" id="L458">            + h.getTopnltype()</span>
            + &quot;.wegdeel (&quot;
<span class="fc" id="L460">            + getTopNLEntityColumns()</span>
            + &quot;,typeInfrastructuur,typeWeg,hoofdverkeersgebruik,fysiekVoorkomen,verhardingsbreedteklasse,gescheidenRijbaan,verhardingstype,aantalRijstroken,hoogteniveau,status,naam,isBAGnaam,aWegnummer,nWegnummer,eWegnummer,sWegnummer,afritnummer,afritnaam,knooppuntnaam,brugnaam,tunnelnaam,hartGeometrie,geometrie) VALUES (&quot;
<span class="fc" id="L462">            + getTopNLEntityReplacementChars()</span>
            + &quot;,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)&quot;;
<span class="fc" id="L464">    Wegdeel inserted = run.insert(query, handler, args);</span>

<span class="fc" id="L466">    return inserted;</span>
  }

  private FunctioneelGebied saveFunctioneelGebied(TopNLEntity entity)
      throws SQLException, ParseException {
<span class="fc" id="L471">    FunctioneelGebied h = (FunctioneelGebied) entity;</span>

<span class="fc" id="L473">    ResultSetHandler&lt;FunctioneelGebied&gt; handler =</span>
        new BeanHandler(
            FunctioneelGebied.class,
            new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L477">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L478">    Object[] args =</span>
<span class="fc" id="L479">        getVarargs(</span>
            entity,
<span class="fc" id="L481">            h.getTypeFunctioneelGebied(),</span>
<span class="fc" id="L482">            h.getSoortnaam(),</span>
<span class="fc" id="L483">            h.getNaamNL(),</span>
<span class="fc" id="L484">            h.getNaamFries(),</span>
            nativeGeom);
<span class="fc" id="L486">    FunctioneelGebied inserted =</span>
<span class="fc" id="L487">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L489">                + h.getTopnltype()</span>
                + &quot;.functioneelgebied (&quot;
<span class="fc" id="L491">                + getTopNLEntityColumns()</span>
                + &quot;,typefunctioneelgebied,soortnaam,naamnl,naamfries,geometrie) VALUES (&quot;
<span class="fc" id="L493">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L498">    return inserted;</span>
  }

  private Hoogte saveHoogte(TopNLEntity entity) throws SQLException, ParseException {
<span class="fc" id="L502">    Hoogte h = (Hoogte) entity;</span>

<span class="fc" id="L504">    ResultSetHandler&lt;Hoogte&gt; handler =</span>
        new BeanHandler(
            Hoogte.class, new BasicRowProcessor(new DbUtilsGeometryColumnConverter(gjc)));
<span class="fc" id="L507">    Object nativeGeom = gjc.convertToNativeGeometryObject(h.getGeometrie());</span>
<span class="fc" id="L508">    Object[] args =</span>
<span class="fc" id="L509">        getVarargs(entity, h.getTypeHoogte(), h.getReferentieVlak(), h.getHoogte(), nativeGeom);</span>
<span class="fc" id="L510">    Hoogte inserted =</span>
<span class="fc" id="L511">        run.insert(</span>
            &quot;INSERT INTO &quot;
<span class="fc" id="L513">                + h.getTopnltype()</span>
                + &quot;.hoogte (&quot;
<span class="fc" id="L515">                + getTopNLEntityColumns()</span>
                + &quot;,typeHoogte,referentieVlak,hoogte, geometrie) VALUES (&quot;
<span class="fc" id="L517">                + getTopNLEntityReplacementChars()</span>
                + &quot;,?,?,?,?)&quot;,
            handler,
            args);

<span class="fc" id="L522">    return inserted;</span>
  }

  private String getTopNLEntityColumns() {
<span class="fc" id="L526">    return &quot;identificatie,topnltype,brontype,bronactualiteit,bronbeschrijving,bronnauwkeurigheid,objectBeginTijd,objectEindTijd,visualisatieCode&quot;;</span>
  }

  private String getTopNLEntityReplacementChars() {
<span class="fc" id="L530">    return &quot;?,?,?,?,?,?,?,?,?&quot;;</span>
  }

  private Object[] getVarargs(TopNLEntity entity, Object... specificArgs) {
<span class="fc" id="L534">    Object[] genericArgs = {</span>
<span class="fc" id="L535">      entity.getIdentificatie(),</span>
<span class="fc" id="L536">      entity.getTopnltype(),</span>
<span class="fc" id="L537">      entity.getBrontype(),</span>
<span class="pc bpc" id="L538" title="1 of 2 branches missed.">      entity.getBronactualiteit() != null</span>
<span class="fc" id="L539">          ? new java.sql.Date(entity.getBronactualiteit().getTime())</span>
<span class="pc" id="L540">          : null,</span>
<span class="fc" id="L541">      entity.getBronbeschrijving(),</span>
<span class="fc" id="L542">      entity.getBronnauwkeurigheid(),</span>
<span class="pc bpc" id="L543" title="1 of 2 branches missed.">      entity.getObjectBeginTijd() != null</span>
<span class="fc" id="L544">          ? new java.sql.Date(entity.getObjectBeginTijd().getTime())</span>
<span class="pc" id="L545">          : null,</span>
<span class="fc bfc" id="L546" title="All 2 branches covered.">      entity.getObjectEindTijd() != null</span>
<span class="fc" id="L547">          ? new java.sql.Date(entity.getObjectEindTijd().getTime())</span>
<span class="fc" id="L548">          : null,</span>
<span class="fc" id="L549">      entity.getVisualisatieCode()</span>
    };
<span class="fc" id="L551">    int numGeneric = genericArgs.length;</span>
<span class="fc" id="L552">    Object[] completeArgs = new Object[numGeneric + specificArgs.length];</span>
<span class="fc" id="L553">    System.arraycopy(genericArgs, 0, completeArgs, 0, numGeneric);</span>

<span class="fc bfc" id="L555" title="All 2 branches covered.">    for (int i = 0; i &lt; specificArgs.length; i++) {</span>
<span class="fc" id="L556">      Object specificArg = specificArgs[i];</span>
<span class="fc" id="L557">      completeArgs[numGeneric + i] = specificArg;</span>
    }

<span class="fc" id="L560">    return completeArgs;</span>
  }

  public GeometryJdbcConverter getGjc() {
<span class="fc" id="L564">    return gjc;</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>