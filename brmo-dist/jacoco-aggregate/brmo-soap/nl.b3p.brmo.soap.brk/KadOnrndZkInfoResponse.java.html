<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>KadOnrndZkInfoResponse.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">BRMO distributie</a> &gt; <a href="../index.html" class="el_bundle">brmo-soap</a> &gt; <a href="index.source.html" class="el_package">nl.b3p.brmo.soap.brk</a> &gt; <span class="el_source">KadOnrndZkInfoResponse.java</span></div><h1>KadOnrndZkInfoResponse.java</h1><pre class="source lang-java linenums">package nl.b3p.brmo.soap.brk;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.Date;
import java.util.Map;
import javax.sql.DataSource;
import javax.xml.bind.annotation.XmlType;
import nl.b3p.brmo.service.util.ConfigUtil;
import nl.b3p.brmo.soap.db.BrkInfo;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

/**
 * @author Chris
 */
@XmlType
public class KadOnrndZkInfoResponse {

<span class="nc" id="L21">  private static final Log LOG = LogFactory.getLog(KadOnrndZkInfoResponse.class);</span>

  private String gemeentecode;
  private String sectie;
  private String perceelnummer;
  private String appReVolgnummer;
  private String identificatie;
  private String aandSoortGrootte;
  private String begrenzingPerceel;
  private Float groottePerceel;
  private String omschr_deelperceel;
  private String aardCultuurOnbebouwd;
  private Date datumBeginGeldigheid;
  private Date datumEindeGeldigheid;
  private Float bedrag;
  private Integer koopjaar;
  private Boolean meerOnroerendgoed;
  private String type; // appartement of perceel
  private AdressenResponse adressen;
  private RechtenResponse rechten;
  private RelatiesResponse relaties;

<span class="nc" id="L43">  public KadOnrndZkInfoResponse() {}</span>

  /**
   * Afkorting voor kadastrale gemeente als gebruikt in AKR
   *
   * @return the gemeentecode
   */
  public String getGemeentecode() {
<span class="nc" id="L51">    return gemeentecode;</span>
  }

  /**
   * Afkorting voor kadastrale gemeente als gebruikt in AKR
   *
   * @param gemeentecode the gemeentecode to set
   */
  public void setGemeentecode(String gemeentecode) {
<span class="nc" id="L60">    this.gemeentecode = gemeentecode;</span>
<span class="nc" id="L61">  }</span>

  /**
   * Letter van sectie
   *
   * @return the sectie
   */
  public String getSectie() {
<span class="nc" id="L69">    return sectie;</span>
  }

  /**
   * Letter van sectie
   *
   * @param sectie the sectie to set
   */
  public void setSectie(String sectie) {
<span class="nc" id="L78">    this.sectie = sectie;</span>
<span class="nc" id="L79">  }</span>

  /**
   * nummer van het perceel
   *
   * @return the perceelnummer
   */
  public String getPerceelnummer() {
<span class="nc" id="L87">    return perceelnummer;</span>
  }

  /**
   * nummer van het perceel
   *
   * @param perceelnummer the perceelnummer to set
   */
  public void setPerceelnummer(String perceelnummer) {
<span class="nc" id="L96">    this.perceelnummer = perceelnummer;</span>
<span class="nc" id="L97">  }</span>

  /**
   * In geval van een appartement kan hier het volgnummer worden opgegeven
   *
   * @return the appReVolgnummer
   */
  public String getAppReVolgnummer() {
<span class="nc" id="L105">    return appReVolgnummer;</span>
  }

  /**
   * In geval van een appartement kan hier het volgnummer worden opgegeven
   *
   * @param appReVolgnummer the appReVolgnummer to set
   */
  public void setAppReVolgnummer(String appReVolgnummer) {
<span class="nc" id="L114">    this.appReVolgnummer = appReVolgnummer;</span>
<span class="nc" id="L115">  }</span>

  /**
   * Formele kadatstrale object nummer
   *
   * @return the identificatie
   */
  public String getIdentificatie() {
<span class="nc" id="L123">    return identificatie;</span>
  }

  /**
   * Formele kadatstrale object nummer
   *
   * @param identificatie the identificatie to set
   */
  public void setIdentificatie(String identificatie) {
<span class="nc" id="L132">    this.identificatie = identificatie;</span>
<span class="nc" id="L133">  }</span>

  /**
   * @return the aandSoortGrootte
   */
  public String getAandSoortGrootte() {
<span class="nc" id="L139">    return aandSoortGrootte;</span>
  }

  /**
   * @param aandSoortGrootte the aandSoortGrootte to set
   */
  public void setAandSoortGrootte(String aandSoortGrootte) {
<span class="nc" id="L146">    this.aandSoortGrootte = aandSoortGrootte;</span>
<span class="nc" id="L147">  }</span>

  /**
   * @return the begrenzingPerceel
   */
  public String getBegrenzingPerceel() {
<span class="nc" id="L153">    return begrenzingPerceel;</span>
  }

  /**
   * @param begrenzingPerceel the begrenzingPerceel to set
   */
  public void setBegrenzingPerceel(String begrenzingPerceel) {
<span class="nc" id="L160">    this.begrenzingPerceel = begrenzingPerceel;</span>
<span class="nc" id="L161">  }</span>

  /**
   * @return the groottePerceel
   */
  public Float getGroottePerceel() {
<span class="nc" id="L167">    return groottePerceel;</span>
  }

  /**
   * @param groottePerceel the groottePerceel to set
   */
  public void setGroottePerceel(Float groottePerceel) {
<span class="nc" id="L174">    this.groottePerceel = groottePerceel;</span>
<span class="nc" id="L175">  }</span>

  /**
   * @return the omschr_deelperceel
   */
  public String getOmschr_deelperceel() {
<span class="nc" id="L181">    return omschr_deelperceel;</span>
  }

  /**
   * @param omschr_deelperceel the omschr_deelperceel to set
   */
  public void setOmschr_deelperceel(String omschr_deelperceel) {
<span class="nc" id="L188">    this.omschr_deelperceel = omschr_deelperceel;</span>
<span class="nc" id="L189">  }</span>

  /**
   * @return the aardCultuurOnbebouwd
   */
  public String getAardCultuurOnbebouwd() {
<span class="nc" id="L195">    return aardCultuurOnbebouwd;</span>
  }

  /**
   * @param aardCultuurOnbebouwd the aardCultuurOnbebouwd to set
   */
  public void setAardCultuurOnbebouwd(String aardCultuurOnbebouwd) {
<span class="nc" id="L202">    this.aardCultuurOnbebouwd = aardCultuurOnbebouwd;</span>
<span class="nc" id="L203">  }</span>

  /**
   * @return the datumBeginGeldigheid
   */
  public Date getDatumBeginGeldigheid() {
<span class="nc" id="L209">    return datumBeginGeldigheid;</span>
  }

  /**
   * @param datumBeginGeldigheid the datumBeginGeldigheid to set
   */
  public void setDatumBeginGeldigheid(Date datumBeginGeldigheid) {
<span class="nc" id="L216">    this.datumBeginGeldigheid = datumBeginGeldigheid;</span>
<span class="nc" id="L217">  }</span>

  /**
   * @return the datumEindeGeldigheid
   */
  public Date getDatumEindeGeldigheid() {
<span class="nc" id="L223">    return datumEindeGeldigheid;</span>
  }

  /**
   * @param datumEindeGeldigheid the datumEindeGeldigheid to set
   */
  public void setDatumEindeGeldigheid(Date datumEindeGeldigheid) {
<span class="nc" id="L230">    this.datumEindeGeldigheid = datumEindeGeldigheid;</span>
<span class="nc" id="L231">  }</span>

  /**
   * @return the bedrag
   */
  public Float getBedrag() {
<span class="nc" id="L237">    return bedrag;</span>
  }

  /**
   * @param bedrag the bedrag to set
   */
  public void setBedrag(Float bedrag) {
<span class="nc" id="L244">    this.bedrag = bedrag;</span>
<span class="nc" id="L245">  }</span>

  /**
   * @return the koopjaar
   */
  public Integer getKoopjaar() {
<span class="nc" id="L251">    return koopjaar;</span>
  }

  /**
   * @param koopjaar the koopjaar to set
   */
  public void setKoopjaar(Integer koopjaar) {
<span class="nc" id="L258">    this.koopjaar = koopjaar;</span>
<span class="nc" id="L259">  }</span>

  /**
   * @return the meerOnroerendgoed
   */
  public Boolean isMeerOnroerendgoed() {
<span class="nc" id="L265">    return meerOnroerendgoed;</span>
  }

  /**
   * @param meerOnroerendgoed the meerOnroerendgoed to set
   */
  public void setMeerOnroerendgoed(Boolean meerOnroerendgoed) {
<span class="nc" id="L272">    this.meerOnroerendgoed = meerOnroerendgoed;</span>
<span class="nc" id="L273">  }</span>

  /**
   * @return the type
   */
  public String getType() {
<span class="nc" id="L279">    return type;</span>
  }

  /**
   * @param type the type to set
   */
  public void setType(String type) {
<span class="nc" id="L286">    this.type = type;</span>
<span class="nc" id="L287">  }</span>

  /**
   * @return the adressen
   */
  public AdressenResponse getAdressen() {
<span class="nc" id="L293">    return adressen;</span>
  }

  /**
   * @param adressen the adressen to set
   */
  public void setAdressen(AdressenResponse adressen) {
<span class="nc" id="L300">    this.adressen = adressen;</span>
<span class="nc" id="L301">  }</span>

  /**
   * @return the rechten
   */
  public RechtenResponse getRechten() {
<span class="nc" id="L307">    return rechten;</span>
  }

  /**
   * @param rechten the rechten to set
   */
  public void setRechten(RechtenResponse rechten) {
<span class="nc" id="L314">    this.rechten = rechten;</span>
<span class="nc" id="L315">  }</span>

  /**
   * @return the relaties
   */
  public RelatiesResponse getRelaties() {
<span class="nc" id="L321">    return relaties;</span>
  }

  /**
   * @param relaties the relaties to set
   */
  public void setRelaties(RelatiesResponse relaties) {
<span class="nc" id="L328">    this.relaties = relaties;</span>
<span class="nc" id="L329">  }</span>

  private static StringBuilder createFullColumnsSQL() {
<span class="nc" id="L332">    StringBuilder sql = new StringBuilder();</span>
<span class="nc" id="L333">    sql.append(&quot;    app_re.ka_sectie AS app_re_sectie,&quot;);</span>
<span class="nc" id="L334">    sql.append(&quot;    app_re.ka_perceelnummer  AS app_re_perceelnummer,&quot;);</span>
<span class="nc" id="L335">    sql.append(&quot;    app_re.ka_kad_gemeentecode AS app_re_kad_gemeentecode,&quot;);</span>
<span class="nc" id="L336">    sql.append(&quot;    app_re.ka_appartementsindex,&quot;);</span>
<span class="nc" id="L337">    sql.append(&quot;    kad_perceel.ka_sectie,&quot;);</span>
<span class="nc" id="L338">    sql.append(&quot;    kad_perceel.ka_perceelnummer,&quot;);</span>
<span class="nc" id="L339">    sql.append(&quot;    kad_perceel.ka_kad_gemeentecode,&quot;);</span>
<span class="nc" id="L340">    sql.append(&quot;    kad_perceel.ka_deelperceelnummer,&quot;);</span>
<span class="nc" id="L341">    sql.append(&quot;    kad_onrrnd_zk.dat_beg_geldh,&quot;);</span>
<span class="nc" id="L342">    sql.append(&quot;    kad_onrrnd_zk.datum_einde_geldh,&quot;);</span>
<span class="nc" id="L343">    sql.append(&quot;    kad_onrrnd_zk.kad_identif,&quot;);</span>
<span class="nc" id="L344">    sql.append(&quot;    kad_perceel.aand_soort_grootte,&quot;);</span>
<span class="nc" id="L345">    sql.append(&quot;    kad_onrrnd_zk.cu_aard_cultuur_onbebouwd,&quot;);</span>
<span class="nc" id="L346">    sql.append(&quot;    kad_onrrnd_zk.lr_bedrag,&quot;);</span>
<span class="nc" id="L347">    sql.append(&quot;    kad_perceel.begrenzing_perceel,&quot;);</span>
<span class="nc" id="L348">    sql.append(&quot;    kad_perceel.grootte_perceel,&quot;);</span>
<span class="nc" id="L349">    sql.append(&quot;    kad_onrrnd_zk.ks_koopjaar,&quot;);</span>
<span class="nc" id="L350">    sql.append(&quot;    kad_onrrnd_zk.ks_meer_onroerendgoed,&quot;);</span>
<span class="nc" id="L351">    sql.append(&quot;    kad_perceel.omschr_deelperceel &quot;);</span>
<span class="nc" id="L352">    return sql;</span>
  }

  private static StringBuilder createFromSQL() {
<span class="nc" id="L356">    StringBuilder sql = new StringBuilder();</span>
<span class="nc" id="L357">    sql.append(&quot;    kad_onrrnd_zk &quot;);</span>
<span class="nc" id="L358">    sql.append(&quot;LEFT OUTER JOIN &quot;);</span>
<span class="nc" id="L359">    sql.append(&quot;    kad_perceel &quot;);</span>
<span class="nc" id="L360">    sql.append(&quot;ON &quot;);</span>
<span class="nc" id="L361">    sql.append(&quot;    ( &quot;);</span>
<span class="nc" id="L362">    sql.append(&quot;        kad_onrrnd_zk.kad_identif = kad_perceel.sc_kad_identif) &quot;);</span>
<span class="nc" id="L363">    sql.append(&quot;LEFT OUTER JOIN &quot;);</span>
<span class="nc" id="L364">    sql.append(&quot;    app_re &quot;);</span>
<span class="nc" id="L365">    sql.append(&quot;ON &quot;);</span>
<span class="nc" id="L366">    sql.append(&quot;    ( &quot;);</span>
<span class="nc" id="L367">    sql.append(&quot;        kad_onrrnd_zk.kad_identif = app_re.sc_kad_identif) &quot;);</span>
<span class="nc" id="L368">    return sql;</span>
  }

  private static StringBuilder createWhereSQL() {
<span class="nc" id="L372">    StringBuilder sql = new StringBuilder();</span>
<span class="nc" id="L373">    sql.append(&quot;    kad_onrrnd_zk.kad_identif = ? &quot;);</span>
<span class="nc" id="L374">    return sql;</span>
  }

  public static KadOnrndZkInfoResponse getRecord(Long id, Map&lt;String, Object&gt; searchContext)
      throws Exception {

<span class="nc" id="L380">    DataSource ds = ConfigUtil.getDataSourceRsgb();</span>
<span class="nc" id="L381">    PreparedStatement stm = null;</span>
<span class="nc" id="L382">    Connection connRsgb = null;</span>
<span class="nc" id="L383">    ResultSet rs = null;</span>
    try {
<span class="nc" id="L385">      connRsgb = ds.getConnection();</span>
<span class="nc" id="L386">      StringBuilder sql = new StringBuilder();</span>
<span class="nc" id="L387">      sql.append(&quot;SELECT &quot;);</span>
<span class="nc" id="L388">      sql.append(createFullColumnsSQL());</span>
<span class="nc" id="L389">      sql.append(&quot;FROM &quot;);</span>
<span class="nc" id="L390">      sql.append(createFromSQL());</span>
<span class="nc" id="L391">      sql.append(&quot;WHERE &quot;);</span>
<span class="nc" id="L392">      sql.append(createWhereSQL());</span>
<span class="nc" id="L393">      LOG.trace(sql);</span>
<span class="nc" id="L394">      LOG.trace(id);</span>
<span class="nc" id="L395">      stm = connRsgb.prepareStatement(sql.toString());</span>
<span class="nc" id="L396">      stm.setLong(1, id);</span>
<span class="nc" id="L397">      rs = stm.executeQuery();</span>

<span class="nc" id="L399">      KadOnrndZkInfoResponse koz = new KadOnrndZkInfoResponse();</span>
<span class="nc bnc" id="L400" title="All 2 branches missed.">      if (rs.next()) {</span>
<span class="nc" id="L401">        koz.setIdentificatie(Long.toString(rs.getLong(&quot;kad_identif&quot;)));</span>
<span class="nc" id="L402">        koz.setAandSoortGrootte(rs.getString(&quot;aand_soort_grootte&quot;));</span>
<span class="nc" id="L403">        koz.setAardCultuurOnbebouwd(rs.getString(&quot;cu_aard_cultuur_onbebouwd&quot;));</span>
<span class="nc" id="L404">        koz.setBedrag(rs.getFloat(&quot;lr_bedrag&quot;));</span>
<span class="nc" id="L405">        koz.setDatumBeginGeldigheid(rs.getDate(&quot;dat_beg_geldh&quot;));</span>
<span class="nc" id="L406">        koz.setDatumEindeGeldigheid(rs.getDate(&quot;datum_einde_geldh&quot;));</span>
<span class="nc" id="L407">        koz.setKoopjaar(rs.getInt(&quot;ks_koopjaar&quot;));</span>
        // ks_meer_onroerendgoed is 'J' of 'N' string, geen boolean
<span class="nc" id="L409">        koz.setMeerOnroerendgoed(rs.getString(&quot;ks_meer_onroerendgoed&quot;).equalsIgnoreCase(&quot;J&quot;));</span>
<span class="nc" id="L410">        String type = &quot;perceel&quot;;</span>
<span class="nc bnc" id="L411" title="All 2 branches missed.">        if (rs.getString(&quot;ka_appartementsindex&quot;) != null) {</span>
<span class="nc" id="L412">          type = &quot;appartement&quot;;</span>
        }
<span class="nc" id="L414">        koz.setType(type);</span>
<span class="nc bnc" id="L415" title="All 2 branches missed.">        if (type.equalsIgnoreCase(&quot;appartement&quot;)) {</span>
<span class="nc" id="L416">          koz.setGemeentecode(rs.getString(&quot;app_re_kad_gemeentecode&quot;));</span>
<span class="nc" id="L417">          koz.setPerceelnummer(rs.getString(&quot;app_re_perceelnummer&quot;));</span>
<span class="nc" id="L418">          koz.setSectie(rs.getString(&quot;app_re_sectie&quot;));</span>
<span class="nc" id="L419">          koz.setAppReVolgnummer(rs.getString(&quot;ka_appartementsindex&quot;));</span>
        } else {
<span class="nc" id="L421">          koz.setGemeentecode(rs.getString(&quot;ka_kad_gemeentecode&quot;));</span>
<span class="nc" id="L422">          koz.setPerceelnummer(rs.getString(&quot;ka_perceelnummer&quot;));</span>
<span class="nc" id="L423">          koz.setSectie(rs.getString(&quot;ka_sectie&quot;));</span>
          //                koz.setBegrenzingPerceel(rs.getString(&quot;begrenzing_perceel&quot;));
<span class="nc" id="L425">          koz.setGroottePerceel(rs.getFloat(&quot;grootte_perceel&quot;));</span>
<span class="nc" id="L426">          koz.setOmschr_deelperceel(rs.getString(&quot;omschr_deelperceel&quot;));</span>
        }

<span class="nc" id="L429">        koz.setRechten(RechtenResponse.getRechtenByKoz(id, searchContext));</span>
<span class="nc" id="L430">        Boolean at = (Boolean) searchContext.get(BrkInfo.ADRESSENTOEVOEGEN);</span>
<span class="nc bnc" id="L431" title="All 4 branches missed.">        if (at != null &amp;&amp; at) {</span>
<span class="nc" id="L432">          koz.setAdressen(AdressenResponse.getAdressenByKoz(id));</span>
        }
        //            koz.setRelaties(null);

<span class="nc" id="L436">      } else {</span>
<span class="nc" id="L437">        return null;</span>
      }
<span class="nc" id="L439">      return koz;</span>

    } finally {
<span class="nc bnc" id="L442" title="All 2 branches missed.">      if (rs != null) {</span>
<span class="nc" id="L443">        rs.close();</span>
      }
<span class="nc bnc" id="L445" title="All 2 branches missed.">      if (stm != null) {</span>
<span class="nc" id="L446">        stm.close();</span>
      }
<span class="nc bnc" id="L448" title="All 2 branches missed.">      if (connRsgb != null) {</span>
<span class="nc" id="L449">        connRsgb.close();</span>
      }
    }
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>